# 区块链初始化

1. 初始设定4个账户,1个挖矿账户,1个车辆账户和2个乘客账户
账户已在创世块中写入余额

执行wx4_init.sh,完成区块链启动

2. 解锁账户
for (var i = 0; i < eth.accounts.length; i++) {
    personal.unlockAccount(eth.accounts[i],"123",30000)
}

1. 部署合约
分别复制contracts_abi_wx4.txt中的两个合约部署内容,完成两个合约的部署

```js
miner.start(1); admin.sleepBlocks(4); miner.stop()
```

记录合约地址:

| 合约 | 地址 |
| :---: | :---: |
| StoreMap | 0x23b98f92ceac005e570b6768da377b3abd11012e |
| StoreTraffic | 0xfa6b8f0b92b323c28557faf69da028e33856f6ca |

# 上传地图数据
在仓库的`upload_map`路径下找到`uploadmap_wx4.js`文件，打开并修改一下其中的内容：

```js
// -- snip --

// contract address 
var myContractInstance = MyContract.at("StoreMap合约的地址");
var account = "eth.accounts[0]的内容";

// -- snip --
```

注意其中发送交易的位置position需要为wx4范围,不然无法打包交易

# 启动车辆和乘客
1. 启动车辆
在文件夹`taxi_experiment`中找到`vehicle.js`,打开并修改其中的`mapContractAddress`和`trafficContractAddress`

车辆和乘客的账户信息记录在`accountResult`下面的两个json文件中,目前只有一辆车和2个乘客

2. 启动乘客
`p5.js`,`p6.js`和`passenger_region7.js`都是乘客端文件,启动前,需要先修改文件中的合约地址和交易中的位置,目前只对`p5.js`做了修改

# 执行结果保存
不同脚本中都会将执行结果自动保存在指定的位置,注意查看结果



